### Filcoin出块权算法原理

### 排列

首先，从 $n$ 个人中 取出  $m$ 个人，如果取出来的顺序不同就是不同的结果的话，那么第一个人有 ![n](https://zhangxiaopan.net/wp-content/ql-cache/quicklatex.com-ec4217f4fa5fcd92a9edceba0e708cf7_l3.svg) 种选择，
第二个人对于前面$ n $种选择没一种, 都有 $n - 1$ 种选择，。。。 最后一个人有 $n - m + 1$ 种选择.
所以排列的数量有:

 $P_n^m = n(n-1)(n-2)...(n-m+1)$

### 组合

假设从 $n$ 个人中取出 $m$ 个人, 有 $C_n^m$ 种方法, 对于每一种取法, 对取出的 $m$ 个人进行排序, 其总和等于$P_n^m$,所以下面的等式成立:

$\begin{aligned}
C_n^m * m! &= P_n^m => \\
C_n^m &= \frac{P_n^m}{m!}\end{aligned}$

### 二项式分布

#### 二项式分布概念

假设下面的情况:

**老王是条单身狗的屌丝程序员**, 
想着怎么找一个妹子, 老王想了一个大面积撒网的办法:打算遇到一个妹子, 就去跟她表白;
老王觉得自己还挺有魅力, 所以他假设自己每表白4次就会成功1次, 
所以每次表白成功的概率为$p=0.25; $则表白失败的概率为 $q=1-p=0.75$​
老王现在想算一下,如果自己对100个妹子表白, 被其中10个妹子看中的概率是多少呢?

对于100次都表白, 我们每次都用$x$来表示表白的结果:

$$\underbrace{x,x,\cdots,x}_{100}$$

这个$x$有可能是 $p$ 的概率(成功), 也可能是$1-p$(失败), 由于有10次成功, 我们可以把这10次成功随机的放到100个$x$的位置上.

一共有多少种放法?这是一个组合, 即:$C_{100}^{10}$,而基于出现在$C_{100}^{10}$中的每一种情况, 其出现的概率都是$p^{10}(q)^{90}$,只是p和q出现的顺序不一样而已.

所以, 可以得出如果老王对100个女孩表白, 成功10次的概率是:

$$C_{100}^{10}p^{10}(1-p)^{90}$$

#### 概率质量函数(probability mass function)

根据上面的结果可以得出一个普遍的公式, 对于是n个独立的成功/失败试验中成功的次数的离散概率分布，

其中每次试验的成功概率为p,失败的概率为1-p, 则实验n次成功k次的概率为一个函数记为:

$$f(k, n, p) = C_n^mp^k(1-p)^{n-k}$$

**这个$f(k,n,p)$函数称为:'概率质量函数',用于计算对于概率为p的随机(0/1)事件, 重复试验n次, 出现k次的概率**

在wolfram上可以看到[**表白这件事的概率分布**](https://www.wolframalpha.com/input/?i=plot+binomial%28n%2Cx%29*p%5Ex*+%281-p%29%5E%28n+-+x%29%2C+x%3D10..40%2C+p%3D0.25%2C+n%3D100)如下图:
<img src="https://github.com/zl03jsj/hdwallet/blob/master/res/image-20210609092129101.png?raw=true" style="zoom: 33%;" />

#### 累积分布函数(Cumulative Distribution Function)

老王作为一条单身汪, 也不是没有原因的, 想着想着, 竟然产生了另外一个想法(开始研究数学问题了):

**那我表白100次,成功10次到15次的概率是多少呢?**

所以老王把自己成功10次, 11次, 12..15次的概率加起来,得出下面的函数:

$$F(K, n, p) = \sum_{k=10}^{15}{C_n^mp^k(1-p)^{n-k}}\qquad(p=0.25, n=100)$$

$F(K,n,p)$函数就是老王**表白成功的[累积分布函数](https://www.wolframalpha.com/input/?i=CDF%5BBinomialDistribution%5B100%2C+0.25%5D%2C+x%5D)**如图:
<img src="https://github.com/zl03jsj/hdwallet/blob/master/res/image-20210609111715395.png?raw=true" alt="累积分布函数图形" style="zoom:50%;" />

**老王表白是一个离散的事件, 在连续的情况下, 累积分布函数应该是取积分**:

$$F(K, n, p) = \int\nolimits_{10}^{15}{C_n^mp^k(1-p)^{n-k}}\qquad(p=0.25, n=100)$$

### 泊松分布

